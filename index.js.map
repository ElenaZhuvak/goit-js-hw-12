{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst BASIC_URL = 'https://pixabay.com/api/';\nconst KEY_API = '46224221-307a76b395d66c959be951e41';\n\nexport async function fetchImages(query, page = 1) {\ntry {\n    const response = await axios.get(BASIC_URL, {\n        params: {\n            key: KEY_API,\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            page: page,\n            per_page: 15,\n        }\n    });\n\n    const images = response.data\n            if (images.hits.length === 0) {\n                iziToast.error({\n                    title: 'Error',\n                    message: `Sorry, there are no images matching your search query. Please try again!`,\n                    position: \"topRight\",\n                });\n            }\n        return images;\n}\n    \ncatch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Illegal operation',\n            position: \"topRight\",\n        });\n    }\n}","export function renderGallery(images) {\n    const gallery = document.querySelector('.gallery');\n    gallery.innerHTML = '';\n\n    const markup = images.map(image => `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n                <img \n                    class=\"gallery-image\" \n                    src=\"${image.webformatURL}\" \n                    alt=\"${image.tags}\" \n                    loading=\"lazy\"\n                />\n                <div class=\"image-info\">\n                    <p class=\"info-item\"><b>Likes:</b> ${image.likes}</p>\n                    <p class=\"info-item\"><b>Views:</b> ${image.views}</p>\n                    <p class=\"info-item\"><b>Comments:</b> ${image.comments}</p>\n                    <p class=\"info-item\"><b>Downloads:</b> ${image.downloads}</p>\n                </div>\n            </a>\n        </li>\n    `).join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nconst loaderContainer = document.querySelector('.loader-container');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nexport function showLoader() {\n    loaderContainer.classList.remove('hidden');\n}\nexport function hideLoader() {\n    loaderContainer.classList.add('hidden')\n}\n\nexport function showLoadMore() {\n    loadMoreBtn.classList.remove('hidden');\n}\nexport function hideLoadMore() {\n    loadMoreBtn.classList.add('hidden');\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport {fetchImages} from './js/pixabay-api';\nimport {renderGallery, showLoader, hideLoader, showLoadMore, hideLoadMore} from './js/render-functions';\n\nlet lightbox;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet loadedImages = 0;\n\nconst form = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nform.addEventListener('submit', onSubmit);\n\nasync function onSubmit(event) {\n    event.preventDefault();\n    const query = form.elements.searchInput.value.trim();\n\n        if (query === '') {\n            iziToast.warning({\n                message: 'Please fill in the field',\n                position: \"topRight\",\n            });\n            return;\n        }\n\n    currentQuery = query;\n    currentPage = 1;\n    loadedImages = 0;\n    gallery.innerHTML = '';\n    hideLoadMore();\n    showLoader();\n\n    try {\n        const data = await fetchImages(query, currentPage);\n        totalHits = data.totalHits;\n        loadedImages+= data.hits.length;\n\n        if (data.hits.length > 0) {\n            renderGallery(data.hits);\n            initializeLightbox();\n            checkEndOfCollection();\n        } else {\n            iziToast.info({\n                message: \"Sorry, there are no images matching your search query. Please try again\",\n                position: \"topRight\",\n            })\n        }\n\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'An error occurred while fetching images. Please try again',\n            position: \"topRight\",\n        });\n    }\n    hideLoader();\n    form.reset();\n}\n// ** =============================================== ** \nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onLoadMore() {\n    currentPage += 1;\n    showLoader();\n    hideLoadMore();\n\n    try {\n        const data = await fetchImages(currentQuery, currentPage);\n\n        if (data.hits.length > 0) {\n            loadedImages += data.hits.length;\n            renderGallery(data.hits);\n            lightbox.refresh();\n            if (checkEndOfCollection()) {\n                return\n            }\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'An error occurred while fetching images. Please try again',\n            position: 'topRight',\n        })\n    }\n    hideLoader();\n}\n// ** =============================================== ** \nfunction checkEndOfCollection() {\n    if(loadedImages>= totalHits && totalHits !== 0) {\n        hideLoadMore();\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results\",\n            position: \"topRight\",\n        })\n    } else {\n        showLoadMore()\n    }\n}\n// ** =============================================== ** \nfunction initializeLightbox () {\n    if (lightbox) {\n        lightbox.refresh();\n    } else {\n        lightbox = new SimpleLightbox('.gallery a', {\n            captions: true,\n            captionsData: 'alt',\n            captionDelay: 250,\n        });\n    }\n}\n"],"names":["BASIC_URL","KEY_API","fetchImages","query","page","images","axios","iziToast","renderGallery","gallery","markup","image","loaderContainer","loadMoreBtn","showLoader","hideLoader","showLoadMore","hideLoadMore","lightbox","currentPage","currentQuery","totalHits","loadedImages","form","onSubmit","event","data","initializeLightbox","checkEndOfCollection","onLoadMore","SimpleLightbox"],"mappings":"owBAIA,MAAMA,EAAY,2BACZC,EAAU,qCAET,eAAeC,EAAYC,EAAOC,EAAO,EAAG,CACnD,GAAI,CAaA,MAAMC,GAZW,MAAMC,EAAM,IAAIN,EAAW,CACxC,OAAQ,CACJ,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACb,CACT,CAAK,GAEuB,KAChB,OAAIC,EAAO,KAAK,SAAW,GACvBE,EAAS,MAAM,CACX,MAAO,QACP,QAAS,2EACT,SAAU,UAC9B,CAAiB,EAEFF,CACf,MAEc,CACNE,EAAS,MAAM,CACX,MAAO,QACP,QAAS,oBACT,SAAU,UACtB,CAAS,CACJ,CACL,CCvCO,SAASC,EAAcH,EAAQ,CAClC,MAAMI,EAAU,SAAS,cAAc,UAAU,EACjDA,EAAQ,UAAY,GAEpB,MAAMC,EAASL,EAAO,IAAIM,GAAS;AAAA;AAAA,4CAEKA,EAAM,aAAa;AAAA;AAAA;AAAA,2BAGpCA,EAAM,YAAY;AAAA,2BAClBA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,yDAIoBA,EAAM,KAAK;AAAA,yDACXA,EAAM,KAAK;AAAA,4DACRA,EAAM,QAAQ;AAAA,6DACbA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,KAIvE,EAAE,KAAK,EAAE,EAEVF,EAAQ,mBAAmB,YAAaC,CAAM,CAClD,CAEA,MAAME,EAAkB,SAAS,cAAc,mBAAmB,EAC5DC,EAAc,SAAS,cAAc,YAAY,EAEhD,SAASC,GAAa,CACzBF,EAAgB,UAAU,OAAO,QAAQ,CAC7C,CACO,SAASG,GAAa,CACzBH,EAAgB,UAAU,IAAI,QAAQ,CAC1C,CAEO,SAASI,GAAe,CAC3BH,EAAY,UAAU,OAAO,QAAQ,CACzC,CACO,SAASI,GAAe,CAC3BJ,EAAY,UAAU,IAAI,QAAQ,CACtC,CCjCA,IAAIK,EACAC,EAAc,EACdC,EAAe,GACfC,EAAY,EACZC,EAAe,EAEnB,MAAMC,EAAO,SAAS,cAAc,iBAAiB,EAC/Cd,EAAU,SAAS,cAAc,UAAU,EAC3CI,EAAc,SAAS,cAAc,YAAY,EAEvDU,EAAK,iBAAiB,SAAUC,CAAQ,EAExC,eAAeA,EAASC,EAAO,CAC3BA,EAAM,eAAc,EACpB,MAAMtB,EAAQoB,EAAK,SAAS,YAAY,MAAM,OAE1C,GAAIpB,IAAU,GAAI,CACdI,EAAS,QAAQ,CACb,QAAS,2BACT,SAAU,UAC1B,CAAa,EACD,MACH,CAELa,EAAejB,EACfgB,EAAc,EACdG,EAAe,EACfb,EAAQ,UAAY,GACpBQ,IACAH,IAEA,GAAI,CACA,MAAMY,EAAO,MAAMxB,EAAYC,EAAOgB,CAAW,EACjDE,EAAYK,EAAK,UACjBJ,GAAeI,EAAK,KAAK,OAErBA,EAAK,KAAK,OAAS,GACnBlB,EAAckB,EAAK,IAAI,EACvBC,IACAC,KAEArB,EAAS,KAAK,CACV,QAAS,0EACT,SAAU,UAC1B,CAAa,CAGR,MAAe,CACZA,EAAS,MAAM,CACX,MAAO,QACP,QAAS,4DACT,SAAU,UACtB,CAAS,CACJ,CACDQ,IACAQ,EAAK,MAAK,CACd,CAEAV,EAAY,iBAAiB,QAASgB,CAAU,EAEhD,eAAeA,GAAa,CACxBV,GAAe,EACfL,IACAG,IAEA,GAAI,CACA,MAAMS,EAAO,MAAMxB,EAAYkB,EAAcD,CAAW,EAExD,GAAIO,EAAK,KAAK,OAAS,IACnBJ,GAAgBI,EAAK,KAAK,OAC1BlB,EAAckB,EAAK,IAAI,EACvBR,EAAS,QAAO,EACZU,EAAoB,GACpB,MAGX,MAAe,CACZrB,EAAS,MAAM,CACX,MAAO,QACP,QAAS,4DACT,SAAU,UACtB,CAAS,CACJ,CACDQ,GACJ,CAEA,SAASa,GAAuB,CACzBN,GAAeD,GAAaA,IAAc,GACzCJ,IACAV,EAAS,KAAK,CACV,QAAS,4DACT,SAAU,UACtB,CAAS,GAEDS,EAAc,CAEtB,CAEA,SAASW,GAAsB,CACvBT,EACAA,EAAS,QAAO,EAEhBA,EAAW,IAAIY,EAAe,aAAc,CACxC,SAAU,GACV,aAAc,MACd,aAAc,GAC1B,CAAS,CAET"}